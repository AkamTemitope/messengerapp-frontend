(this.webpackJsonpmessengerapp=this.webpackJsonpmessengerapp||[]).push([[0],{100:function(e,t,n){},101:function(e,t,n){},103:function(e,t,n){},127:function(e,t,n){},128:function(e,t,n){},129:function(e,t,n){},135:function(e,t,n){},136:function(e,t,n){},137:function(e,t,n){},138:function(e,t,n){},139:function(e,t,n){},140:function(e,t,n){},141:function(e,t,n){},177:function(e,t,n){},178:function(e,t,n){"use strict";n.r(t);var c=n(4),o=n.n(c),a=n(50),r=n.n(a),s=(n(65),n(33)),i=n(10),l=n(6),u=n(5),d=n(43),j=Object(d.b)({name:"user",initialState:{user:null,isLoggedIn:!1,loggingIn:!1,is_active:!1,contacts:[],groups:[],error:null,loginError:null,timestamp:null,connected:!0,notifications:[],loading:!1},reducers:{setNotification:function(e,t){e.notification=t.payload},setConnected:function(e,t){e.connected=t.payload},setIsActive:function(e,t){e.user.is_active=t.payload},setLoading:function(e,t){e.loading=t.payload},setIsLoggedIn:function(e,t){e.isLoggedIn=t.payload},setIsLoggingIn:function(e,t){e.isLoggingIn=t.payload},setGroups:function(e,t){e.groups=t.payload},addGroup:function(e,t){e.groups=[].concat(Object(s.a)(e.groups),[t.payload])},removeGroup:function(e,t){var n=[];e.groups.forEach((function(e){e._id!==t.payload._id&&n.push(e)})),e.groups=n},setContacts:function(e,t){e.contacts=t.payload},addContact:function(e,t){e.contacts=[].concat(Object(s.a)(e.contacts),[t.payload])},addNewMessage:function(e,t){"contact"===t.payload.type?e.contacts=e.contacts.map((function(e){if((null===e||void 0===e?void 0:e._id)===t.payload._id){var n=[].concat(Object(s.a)(e.messages),[t.payload.message]);return Object(u.a)(Object(u.a)({},e),{},{messages:n,last_message:t.payload.message})}return e})):e.groups=e.groups.map((function(e){if((null===e||void 0===e?void 0:e._id)===t.payload._id){var n=[].concat(Object(s.a)(e.messages),[t.payload.message]);return Object(u.a)(Object(u.a)({},e),{},{messages:n,last_message:t.payload.message})}return e}))},editUserName:function(e,t){e.user.username=t.payload},editUserNameInConversations:function(e,t){"contact"===t.payload.type?e.contacts=e.contacts.map((function(e){if((null===e||void 0===e?void 0:e._id)===t.payload._id){var n=e.members.map((function(e){return e._id===t.payload.userId?Object(u.a)(Object(u.a)({},e),{},{username:t.payload.username}):e}));return Object(u.a)(Object(u.a)({},e),{},{members:n})}return e})):e.groups=e.groups.map((function(e){if((null===e||void 0===e?void 0:e._id)===t.payload._id){var n=e.members.map((function(e){return e._id===t.payload.userId?Object(u.a)(Object(u.a)({},e),{},{username:t.payload.username}):e}));return Object(u.a)(Object(u.a)({},e),{},{members:n})}return e}))},updateIsActive:function(e,t){"contact"===t.payload.type?e.contacts=e.contacts.map((function(e){if((null===e||void 0===e?void 0:e._id)===t.payload._id){var n=e.members.map((function(e){return e._id===t.payload.userId?Object(u.a)(Object(u.a)({},e),{},{is_active:t.payload.is_active}):e}));return Object(u.a)(Object(u.a)({},e),{},{members:n})}return e})):"group"===t.payload.type?e.groups=e.groups.map((function(e){if((null===e||void 0===e?void 0:e._id)===t.payload._id){var n=e.members.map((function(e){return e._id===t.payload.userId?Object(u.a)(Object(u.a)({},e),{},{is_active:t.payload.is_active}):e}));return Object(u.a)(Object(u.a)({},e),{},{members:n})}return e})):(e.contacts=e.contacts.map((function(e){if((null===e||void 0===e?void 0:e._id)===t.payload._id){var n=e.members.map((function(e){return e._id===t.payload.userId?Object(u.a)(Object(u.a)({},e),{},{is_active:t.payload.is_active}):e}));return Object(u.a)(Object(u.a)({},e),{},{members:n})}return e})),e.groups=e.groups.map((function(e){if((null===e||void 0===e?void 0:e._id)===t.payload._id){var n=e.members.map((function(e){return e._id===t.payload.userId?Object(u.a)(Object(u.a)({},e),{},{is_active:t.payload.is_active}):e}));return Object(u.a)(Object(u.a)({},e),{},{members:n})}return e})))},editGroupName:function(e,t){e.groups=e.groups.map((function(e){return e._id===t.payload._id?Object(u.a)(Object(u.a)({},e),{},{groupname:t.payload.groupname}):e}))},editGroupDescription:function(e,t){e.groups=e.groups.map((function(e){return e._id===t.payload._id?Object(u.a)(Object(u.a)({},e),{},{description:t.payload.description}):e}))},deleteOneMessage:function(e,t){t.payload.type},deleteAllMessages:function(e,t){"contact"===t.payload.type?e.contacts=e.contacts.map((function(e){return(null===e||void 0===e?void 0:e._id)===t.payload._id?Object(u.a)(Object(u.a)({},e),{},{messages:[],last_message:null}):e})):e.groups=e.groups.map((function(e){return(null===e||void 0===e?void 0:e._id)===t.payload._id?Object(u.a)(Object(u.a)({},e),{},{messages:[],last_message:null}):e}))},updateBlockStatus:function(e,t){e.contacts=e.contacts.map((function(e){return(null===e||void 0===e?void 0:e._id)===t.payload._id?Object(u.a)(Object(u.a)({},e),{},{block:t.payload.block}):e}))},updateGroup:function(e,t){e.groups=e.groups.map((function(e){return(null===e||void 0===e?void 0:e._id)===t.payload._id?t.payload.group:e}))},setError:function(e,t){t.payload.error&&(e.error=t.payload.error),t.payload.LoginError&&(e.loginError=t.payload.loginError,e.isLoggedIn=t.payload.isLoggedIn)},login:function(e,t){e.user=t.payload},logout:function(e){e.user=null,e.contacts=[],e.groups=[],e.is_active=!1,e.timestamp=null,e.isLoggedIn=!1,e.isLoggingIn=!1,e.loading=!1,e.error=null,e.loginError=null}}}),b=j.actions,p=b.login,m=b.logout,f=b.setGroups,O=b.setContacts,g=b.setError,v=(b.setLoading,j.actions),h=(v.setNotification,v.setConnected,v.setIsActive),x=v.setIsLoggedIn,_=(v.setIsLoggingIn,v.updateIsActive),y=j.actions,C=y.removeGroup,k=y.updateBlockStatus,N=y.addContact,w=y.addGroup,S=y.deleteAllMessages,M=y.editUserNameInConversations,G=j.actions,E=G.editUserName,D=G.editGroupName,I=G.editGroupDescription,L=(G.deleteContactMessage,G.deleteGroupMessage,G.updateGroup),P=G.addNewMessage,A=function(e){return e.user.user},U=function(e){return e.user.groups},B=function(e){return e.user.contacts},R=j.reducer,T=Object(d.b)({name:"option",initialState:{sidebarSearch:!1,showConversation:"contacts",searchInput:"",toggleProfile:!1,conversation:null,toggleConversation:{_id:null,type:"",toggle:!1},fetchResult:null,update:null},reducers:{setSidebarSearch:function(e,t){e.sidebarSearch=t.payload},setUpdate:function(e,t){e.update=t.payload},setShowConversation:function(e,t){e.showConversation=t.payload},setSearchInput:function(e,t){e.searchInput=t.payload},setToggleProfile:function(e,t){e.toggleProfile=t.payload},setToggleConversation:function(e,t){e.toggleConversation=t.payload},setConversation:function(e,t){e.conversation=t.payload},setFetchResult:function(e,t){e.fetchResult=t.payload}}}),F=T.actions,H=F.setShowConversation,Y=F.setSearchInput,q=F.setToggleProfile,z=F.setToggleConversation,Q=(F.setConversation,T.actions),W=Q.setSidebarSearch,X=(Q.setFetchResult,Q.setUpdate,function(e){return e.option.sidebarSearch}),J=function(e){return e.option.showConversation},K=function(e){return e.option.searchInput},V=function(e){return e.option.toggleProfile},Z=function(e){return e.option.toggleConversation},$=T.reducer,ee=(n(98),n(29)),te=n(190),ne=n(30),ce=n(3);var oe=function(){var e=Object(l.b)(),t=Object(l.c)(A),n=Object(l.c)(Z),o=Object(l.c)(U),a=Object(l.c)(B),r=Object(c.useState)(null),s=Object(i.a)(r,2),d=s[0],j=s[1],b=Object(c.useState)(""),p=Object(i.a)(b,2),m=p[0],f=p[1],O=Object(c.useState)(""),g=Object(i.a)(O,2),v=g[0],h=g[1],x=Object(c.useState)(!1),_=Object(i.a)(x,2),y=_[0],C=_[1];return Object(c.useEffect)((function(){"contact"===n.type?j(a.find((function(e){return e._id===n._id}))):j(o.find((function(e){return e._id===n._id})))}),[n._id,n.type,a,o]),Object(c.useEffect)((function(){var e,c,o,a,r,s;d&&("contact"===n.type?t._id!==d.members[0]._id?(f(null===(e=d.members[0])||void 0===e?void 0:e.username),h(null===(c=d.members[0])||void 0===c?void 0:c.photoUrl),C(null===(o=d.members[0])||void 0===o?void 0:o.is_active)):(f(null===(a=d.members[1])||void 0===a?void 0:a.username),h(null===(r=d.members[1])||void 0===r?void 0:r.photoUrl),C(null===(s=d.members[1])||void 0===s?void 0:s.is_active)):(f(null===d||void 0===d?void 0:d.groupname),h(null===d||void 0===d?void 0:d.photoUrl)))}),[d,n.type,t._id]),Object(ce.jsx)(ce.Fragment,{children:d&&Object(ce.jsxs)("div",{className:"chatHeader",children:[Object(ce.jsxs)("div",{className:"chatHeader_avatar",onClick:function(){return e(z(Object(u.a)(Object(u.a)({},n),{},{toggle:!0})))},children:[Object(ce.jsx)(te.a,{src:v}),Object(ce.jsxs)("span",{children:[m,"contact"===n.type&&Object(ce.jsx)(ee.b,{style:{color:y?"green":"grey"}})]})]}),Object(ce.jsx)(ne.b,{title:"Not working yet"})]})})},ae=(n(100),n(101),n(35)),re=n.n(ae);var se=function(e){var t,n,c=e.message,o=Object(l.c)(A);return Object(ce.jsxs)("div",{className:"message ".concat(o._id!==(null===(t=c.from)||void 0===t?void 0:t._id)&&"left"),children:[Object(ce.jsxs)("div",{className:"message_details",children:[Object(ce.jsx)("p",{children:null===(n=c.from)||void 0===n?void 0:n.username}),Object(ce.jsx)("span",{children:re()(c.timestamp).calendar()})]}),Object(ce.jsx)("p",{children:c.body})]})};var ie=function(){var e=Object(c.useRef)(null),t=Object(l.c)(U),n=Object(l.c)(B),o=Object(l.c)(Z),a=Object(c.useState)({}),r=Object(i.a)(a,2),s=r[0],u=r[1];return Object(c.useEffect)((function(){if("contact"===o.type){var e=n.find((function(e){return e._id===o._id}));u(e)}else{var c=t.find((function(e){return e._id===o._id}));u(c)}}),[o._id,o.type,n,t]),Object(c.useEffect)((function(){e&&e.current.addEventListener("DOMNodeInserted",(function(e){var t=e.currentTarget;t.scroll({top:t.scrollHeight,behavior:"smooth",block:"end",smooth:!0})}))}),[o._id]),Object(ce.jsx)(ce.Fragment,{children:s&&Object(ce.jsx)("div",{className:"chatMessages",ref:e,children:s.messages&&s.messages.map((function(e){return Object(ce.jsx)(se,{message:e},e._id)}))})})},le=(n(103),n(55)),ue=n(82),de=n(9),je=n.n(de),be=n(15),pe=n(79),me=n.n(pe).a.create({baseURL:"https://messengerapp-backend.herokuapp.com/"}),fe=function(e){return me.post("/users/new",e)},Oe=function(e){return me.get("/users/exist?e=".concat(e))},ge=function(e){return me.get("users/email?e=".concat(e))},ve=function(e,t){return me.patch("users/updateName/".concat(e),t)},he=function(e){return me.get("contacts/".concat(e))},xe=function(e){return me.post("contacts/new",e)},_e=function(e,t){return me.post("contacts/newMessage/".concat(e),t)},ye=function(e,t){return me.patch("contacts/updateBlock/".concat(e),t)},Ce=function(e){return me.delete("contacts/deleteMessages/".concat(e))},ke=function(e){return me.get("groups/".concat(e))},Ne=function(e){return me.post("groups/new/",e)},we=function(e,t){return me.post("groups/newMessage/".concat(e),t)},Se=function(e,t){return me.patch("groups/addMember/".concat(e),t)},Me=function(e,t){return me.patch("groups/updateName/".concat(e),t)},Ge=function(e,t){return me.patch("groups/updateDescription/".concat(e),t)},Ee=function(e){return me.delete("groups/deleteMessages/".concat(e))},De=function(e,t){return me.delete("groups/deleteMember/".concat(e,"?_id=").concat(t))},Ie=function(e){return me.delete("groups/deleteGroup/".concat(e))},Le=n(86),Pe={sendMessage:"client message",receiveMessage:"server message",editName:"edit name",updateOnlineStatus:"update is_active status",updateNewStatus:"update old connected user status",join:"user id",joinContact:"join contact",addNewContact:"add a new contact",updateBlock:"update block status",newContactMessage:"new contact message",connectMemberToContact:"connect member to contact",deleteContactMessage:"delete contact message",deleteContactMessages:"delete contact messages",newMessage:"new contact/group message",joinGroup:"join group",editGroupName:"edit group name",newGroupMessage:"new group message",editGroupDescription:"edit group description",addNewMember:"add new member",connectMemberToGroup:"connect member to group",leaveGroup:"leave group",deleteGroupMessage:"delete group message",deleteGroupMessages:"delete group messages",deleteGroup:"delete group",disconnecting:"disconnecting",disconnect:"disconnect"},Ae=null,Ue={transports:["websocket","polling","flashsocket"]},Be=function(e,t){Ae?Ae.emit(e,t):console.log("no socket was connected")},Re=function(e,t){Ae&&Ae.on(e,(function(e){t(S(e))}))},Te=function(e,t){return function(){var n=Object(be.a)(je.a.mark((function n(c){var o;return je.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Oe(e);case 3:o=n.sent,t(o.data),console.log("userExists: all good"),n.next=12;break;case 8:n.prev=8,n.t0=n.catch(0),c(g({error:n.t0})),console.log(n.t0);case 12:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}()},Fe=function(e,t){return function(){var n=Object(be.a)(je.a.mark((function n(c){var o;return je.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,ge(e);case 3:o=n.sent,t(o.data[0]),console.log("fetchUserByEmail"),n.next=12;break;case 8:n.prev=8,n.t0=n.catch(0),c(g({error:n.t0})),console.log(n.t0);case 12:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}()},He=function(e,t){return function(){var n=Object(be.a)(je.a.mark((function n(c){return je.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,ye(e,t);case 3:n.sent&&console.log("Block Status Changed"),n.next=11;break;case 7:n.prev=7,n.t0=n.catch(0),c(g({error:n.t0})),console.log(n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(e){return n.apply(this,arguments)}}()},Ye=function(e,t,n){return function(){var c=Object(be.a)(je.a.mark((function c(o){var a;return je.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,ke(e);case 3:a=c.sent,n(a.data),console.log("fetchGroup: all good"),Be(Pe.joinGroup,{group:a.data,is_active:!0,userId:t._id}),c.next=13;break;case 9:c.prev=9,c.t0=c.catch(0),o(g({error:c.t0})),console.log(c.t0);case 13:case"end":return c.stop()}}),c,null,[[0,9]])})));return function(e){return c.apply(this,arguments)}}()},qe=n(81),ze=n.n(qe);var Qe=function(){var e,t,n,o=Object(l.b)(),a=Object(l.c)(A),r=Object(l.c)(Z),s=Object(l.c)(U),d=Object(l.c)(B),j=Object(c.useState)(""),b=Object(i.a)(j,2),p=b[0],m=b[1],f=Object(c.useState)({}),O=Object(i.a)(f,2),v=O[0],h=O[1],x=Object(c.useState)(!1),_=Object(i.a)(x,2),y=_[0],C=_[1];return Object(c.useEffect)((function(){if("contact"===r.type){var e=d.find((function(e){return e._id===r._id}));h(e)}else{var t=s.find((function(e){return e._id===r._id}));h(t)}m(""),C(!1)}),[r._id,r.type,d,s]),Object(ce.jsx)(ce.Fragment,{children:v&&Object(ce.jsxs)("div",{className:"inputSection",children:[!(null===v||void 0===v||null===(e=v.block)||void 0===e?void 0:e.status)&&Object(ce.jsxs)(ce.Fragment,{children:[Object(ce.jsxs)("form",{children:[Object(ce.jsx)("input",{type:"text",value:p,placeholder:"write message",onChange:function(e){m(e.target.value)},onClick:function(){return C(!1)}}),Object(ce.jsx)("button",{type:"submit",onClick:function(e){if(e.preventDefault(),p.trim()){var t=r._id,n={from:a._id,body:p,timestamp:Date.now()};"contact"===r.type?o(function(e,t,n){return function(){var c=Object(be.a)(je.a.mark((function c(o){var a;return je.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,_e(e,t);case 3:(a=c.sent)&&console.log("Message sent"),o(P({_id:e,type:"contact",message:Object(u.a)(Object(u.a)({},a.data),{},{from:n})})),Be(Pe.newMessage,{_id:e,type:"contact",message:Object(u.a)(Object(u.a)({},a.data),{},{from:n})}),c.next=13;break;case 9:c.prev=9,c.t0=c.catch(0),o(g({error:c.t0})),console.log(c.t0);case 13:case"end":return c.stop()}}),c,null,[[0,9]])})));return function(e){return c.apply(this,arguments)}}()}(t,{message:n},a)):o(function(e,t,n){return function(){var c=Object(be.a)(je.a.mark((function c(o){var a;return je.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,we(e,t);case 3:(a=c.sent)&&console.log("Message sent"),o(P({_id:e,type:"group",message:Object(u.a)(Object(u.a)({},a.data),{},{from:n})})),Be(Pe.newMessage,{_id:e,type:"group",message:Object(u.a)(Object(u.a)({},a.data),{},{from:n})}),c.next=13;break;case 9:c.prev=9,c.t0=c.catch(0),o(g({error:c.t0})),console.log(c.t0);case 13:case"end":return c.stop()}}),c,null,[[0,9]])})));return function(e){return c.apply(this,arguments)}}()}(t,{message:n},a))}m("")},children:"Send"})]}),Object(ce.jsxs)("div",{className:"inputSection_icons",children:[Object(ce.jsx)(le.a,{onClick:function(){return C(!y)},title:"emoji"}),Object(ce.jsx)("div",{className:"emojiPicker",style:{display:y?"inline":"none"},children:Object(ce.jsx)(ze.a,{onEmojiClick:function(e,t){return m(p+" "+t.emoji)},disableSearchBar:!0})}),Object(ce.jsx)(ue.a,{title:"Not working yet"})]})]}),(null===v||void 0===v||null===(t=v.block)||void 0===t?void 0:t.status)&&Object(ce.jsx)("p",{style:{fontSize:"1.3rem"},children:(null===v||void 0===v||null===(n=v.block)||void 0===n?void 0:n.from)===a.email?"Unblock contact to send messages":"You have been blocked"})]})})};n(127);var We=function(){var e=Object(l.c)(Z),t=Object(l.c)(A);return Object(ce.jsx)(ce.Fragment,{children:e.type?Object(ce.jsxs)("div",{className:"chatSection",children:[Object(ce.jsx)(oe,{}),Object(ce.jsx)(ie,{}),Object(ce.jsx)(Qe,{})]}):Object(ce.jsx)("div",{className:"chatSection_empty",children:Object(ce.jsxs)("h1",{children:["Welcome, ",t.username,Object(ce.jsx)("br",{}),"Click on conversation to get started"]})})})};n(128);var Xe=function(){var e,t,n,o,a,r,s=Object(l.c)(A),d=Object(l.b)(),j=Object(l.c)(U),b=Object(l.c)(B),p=Object(l.c)(Z),m=Object(c.useState)({}),f=Object(i.a)(m,2),O=f[0],v=f[1],h=Object(c.useState)(null),x=Object(i.a)(h,2),_=x[0],y=x[1];Object(c.useEffect)((function(){if("contact"===p.type){var e=b.find((function(e){return e._id===p._id}));y(e)}}),[p._id,p.type,b,j]),Object(c.useEffect)((function(){_&&(s._id!==_.members[0]._id?v(_.members[0]):v(_.members[1]))}),[_,s._id]);var C=function(){var e;if(null===_||void 0===_||null===(e=_.block)||void 0===e?void 0:e.status){var t={from:s.email,status:!1};d(He(_._id,{block:t})),d(k({_id:_._id,block:t})),Be(Pe.updateBlock,{_id:_._id,block:t})}else{var n={from:s.email,status:!0};d(He(_._id,{block:n})),d(k({_id:_._id,block:n})),Be(Pe.updateBlock,{_id:_._id,block:n})}},N=Object(c.useState)("none"),w=Object(i.a)(N,2),M=w[0],G=w[1],E=function(){var e=function(){var e;d((e=_._id,function(){var t=Object(be.a)(je.a.mark((function t(n){return je.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ce(e);case 3:t.sent&&console.log("All messages deleted"),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),n(g({error:t.t0})),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}())),d(z(Object(u.a)(Object(u.a)({},p),{},{toggle:!1}))),d(S({_id:_._id,type:"contact"})),Be(Pe.deleteContactMessages,{_id:_._id,type:"contact"})};return Object(ce.jsxs)("div",{className:"deleteMessages",style:{display:"".concat(M)},children:[Object(ce.jsxs)("span",{children:['Are you sure you wanna "DELETE ALL MESSAGES" <<',null===_||void 0===_?void 0:_.groupname,">>?"]}),Object(ce.jsx)("p",{onClick:function(){return e()},children:"Yes"}),Object(ce.jsx)("p",{onClick:function(){return G("none")},children:"No"})]})};return Object(ce.jsxs)("div",{className:"contactProfile",children:[Object(ce.jsxs)("div",{className:"contactProfile_top",children:[Object(ce.jsx)("p",{children:"Contact info"}),Object(ce.jsx)(ne.a,{onClick:function(){return d(z(Object(u.a)(Object(u.a)({},p),{},{type:"contact",toggle:!1})))}})]}),Object(ce.jsxs)("div",{className:"contactProfile_scroll",children:[Object(ce.jsxs)("div",{className:"contactProfile_middle",children:[Object(ce.jsx)("img",{src:O.photoUrl,alt:""}),Object(ce.jsxs)("p",{style:{color:O.is_active?"green":"grey"},children:[Object(ce.jsx)(ee.b,{}),O.is_active?"Online":"Offline"]})]}),Object(ce.jsxs)("div",{className:"contactProfile_details",children:[Object(ce.jsx)("p",{children:O.username}),Object(ce.jsx)("span",{children:O.email})]}),Object(ce.jsxs)("div",{className:"contactProfile_bottom",children:[!(null===_||void 0===_||null===(e=_.block)||void 0===e?void 0:e.status)&&Object(ce.jsx)("button",{className:"contactProfile_block",onClick:C,children:"Block Contact"}),(null===_||void 0===_||null===(t=_.block)||void 0===t?void 0:t.status)&&(null===_||void 0===_||null===(n=_.block)||void 0===n?void 0:n.from)===s.email&&Object(ce.jsx)("button",{className:"contactProfile_block",onClick:C,children:"Unblock Contact"}),(null===_||void 0===_||null===(o=_.block)||void 0===o?void 0:o.status)&&(null===_||void 0===_||null===(a=_.block)||void 0===a?void 0:a.from)!==s.email&&Object(ce.jsxs)("h3",{children:["You have been ",Object(ce.jsx)("span",{style:{fontSize:"1.1rem",color:"red"},children:'"BLOCKED"'})," by ",O.username]}),(null===_||void 0===_?void 0:_.messages.length)>0&&!(null===_||void 0===_||null===(r=_.block)||void 0===r?void 0:r.status)&&Object(ce.jsx)("button",{onClick:function(){return G("flex")},children:"Delete All Messages"}),Object(ce.jsx)(E,{})]})]})]})},Je=(n(129),n(58)),Ke=(Je.a.initializeApp({apiKey:"AIzaSyAFWShrbD94JeQNNqWa1u_w2cVXjQdOjXQ",authDomain:"messengerapp-ab976.firebaseapp.com",projectId:"messengerapp-ab976",storageBucket:"messengerapp-ab976.appspot.com",messagingSenderId:"294237238917",appId:"1:294237238917:web:2816ea0a9baa67ec371bec"}).firestore(),Je.a.auth()),Ve=new Je.a.auth.GoogleAuthProvider;var Ze=function(){var e=Object(l.c)(A),t=Object(l.b)(),n=Object(c.useState)(""),o=Object(i.a)(n,2),a=o[0],r=o[1],s=Object(c.useState)("none"),u=Object(i.a)(s,2),d=u[0],j=u[1];return Object(ce.jsxs)("div",{className:"userProfile",children:[Object(ce.jsxs)("div",{className:"userProfile_top",children:[Object(ce.jsx)("p",{children:"Profile"}),Object(ce.jsx)(ne.a,{onClick:function(e){t(q(!1))}})]}),Object(ce.jsxs)("div",{className:"userProfile_middle",children:[Object(ce.jsx)("img",{src:e.photoUrl,alt:""}),Object(ce.jsxs)("p",{style:{color:e.is_active?"green":"grey"},children:[Object(ce.jsx)(ee.b,{}),e.is_active?"Online":"Offline"]})]}),Object(ce.jsxs)("div",{className:"userProfile_bottom",children:[Object(ce.jsxs)("form",{onSubmit:function(n){n.preventDefault(),a.trim()&&(t(function(e,t,n){return function(){var c=Object(be.a)(je.a.mark((function c(o){return je.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,ve(e,t);case 3:c.sent&&console.log("Username Updated :-)"),Be(Pe.editName,{_id:n._id,username:t.username,contacts:n.contacts,groups:n.groups}),o(E(t.username)),c.next=14;break;case 9:c.prev=9,c.t0=c.catch(0),o(g({error:c.t0})),console.log("err occured"),console.log(c.t0);case 14:case"end":return c.stop()}}),c,null,[[0,9]])})));return function(e){return c.apply(this,arguments)}}()}(e._id,{username:a.trim()},e)),r(""),j("none"))},name:"changeName",style:{display:d},children:[Object(ce.jsx)("input",{value:a,type:"text",placeholder:"Enter name",onChange:function(e){return r(e.target.value)}}),Object(ce.jsx)("button",{type:"submit",children:"Rename"}),Object(ce.jsx)("button",{onClick:function(){r(""),j("none")},children:"Cancel"})]}),Object(ce.jsxs)("p",{children:[e.username," ",Object(ce.jsx)("span",{onClick:function(){return j("flex")},children:"Edit"})]}),Object(ce.jsx)("span",{children:e.email})]}),Object(ce.jsx)("button",{onClick:function(){t(q(!1)),t(m()),Ke.signOut()},className:"userProfile_logout",children:"Logout"})]})},$e=(n(135),n(56));var et=function(e){var t=e.contact,n=Object(l.b)(),o=Object(l.c)(A),a=Object(l.c)(Z),r=Object(c.useState)({}),s=Object(i.a)(r,2),d=s[0],j=s[1];return Object(c.useEffect)((function(){o._id!==t.members[0]._id?j(t.members[0]):j(t.members[1])}),[t.members,o._id]),Object(ce.jsxs)("div",{className:"contactConversation",onClick:function(){n(z(Object(u.a)(Object(u.a)({},a),{},{_id:t._id,type:"contact",toggle:!1})))},children:[Object(ce.jsx)("div",{className:"contactConversation_left",children:Object(ce.jsx)(te.a,{src:d.photoUrl})}),Object(ce.jsxs)("div",{className:"contactConversation_right",children:[Object(ce.jsxs)("div",{className:"contactConversation_right_top",children:[Object(ce.jsx)("p",{children:d.username}),Object(ce.jsx)("span",{children:t.last_message&&re()(t.last_message.timestamp).calendar()}),Object(ce.jsx)($e.a,{title:"Not working yet"})]}),Object(ce.jsx)("div",{className:"contactConversation_right_bottom",children:Object(ce.jsx)("p",{children:t.last_message?t.last_message.body:"No messages"})})]})]})};n(136);var tt=function(e){var t=e.group,n=Object(l.b)(),c=Object(l.c)(Z);return Object(ce.jsxs)("div",{className:"groupConversation",onClick:function(){n(z(Object(u.a)(Object(u.a)({},c),{},{_id:t._id,type:"group",toggle:!1})))},children:[Object(ce.jsx)("div",{className:"groupConversation_left",children:Object(ce.jsx)(te.a,{src:""})}),Object(ce.jsxs)("div",{className:"groupConversation_right",children:[Object(ce.jsxs)("div",{className:"groupConversation_right_top",children:[Object(ce.jsx)("p",{children:t.groupname}),Object(ce.jsx)("span",{children:t.last_message&&re()(t.last_message.timestamp).calendar()}),Object(ce.jsx)($e.a,{title:"Not working yet"})]}),Object(ce.jsx)("div",{className:"groupConversation_right_bottom",children:Object(ce.jsx)("p",{children:t.last_message?t.last_message.body:"No messages"})})]})]})};n(137);function nt(e){var t=e.moreDisplay,n=e.setmoreDisplay,o=Object(c.useState)("none"),a=Object(i.a)(o,2),r=a[0],s=a[1],l=Object(c.useState)("none"),u=Object(i.a)(l,2),d=u[0],j=u[1];return Object(ce.jsxs)(ce.Fragment,{children:[Object(ce.jsxs)("div",{className:"addOptions",style:{display:"".concat(t)},children:[Object(ce.jsx)("p",{onClick:function(){n("none"),s("flex")},children:"Add Group"}),Object(ce.jsx)("p",{onClick:function(){n("none"),j("flex")},children:"Add Contact"}),Object(ce.jsx)("p",{onClick:function(){return n("none")},children:"Cancel"})]}),Object(ce.jsx)(ot,{addContactDisplay:d,setaddContactDisplay:j}),Object(ce.jsx)(ct,{addGroupDisplay:r,setaddGroupDisplay:s})]})}function ct(e){var t=e.addGroupDisplay,n=e.setaddGroupDisplay,o=Object(l.b)(),a=Object(l.c)(A),r=Object(c.useState)(""),s=Object(i.a)(r,2),d=s[0],j=s[1],b=Object(c.useState)(""),p=Object(i.a)(b,2),m=p[0],f=p[1];return Object(ce.jsxs)("div",{className:"addGroupOptions",style:{display:"".concat(t)},children:[Object(ce.jsx)("div",{className:"addGroupOptions_name ",children:Object(ce.jsx)("input",{value:d,onChange:function(e){return j(e.target.value)},required:!0,type:"text",placeholder:"Group name"})}),Object(ce.jsx)("div",{className:"addGroupOptions_des",children:Object(ce.jsx)("textarea",{value:m,spellCheck:!0,placeholder:"Description",rows:"3",name:"Description",onChange:function(e){return f(e.target.value)}})}),Object(ce.jsxs)("div",{className:"addGroupOptions_button",children:[Object(ce.jsx)("p",{type:"submit",onClick:function(){if(d.trim()){var e={groupname:d,description:m,created_at:Date.now(),members:[a._id],messages:[]};o(function(e,t){return function(){var n=Object(be.a)(je.a.mark((function n(c){var o,a;return je.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Ne(e);case 3:(o=n.sent)&&console.log("Group created"),a=Object(u.a)(Object(u.a)({},o.data),{},{members:[t]}),c(w(a)),Be(Pe.joinGroup,{group:a,is_active:!0,userId:t._id}),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(0),c(g({error:n.t0})),console.log(n.t0);case 14:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e){return n.apply(this,arguments)}}()}({group:e},a)),j(""),f(""),n("none")}},children:"Create"}),Object(ce.jsx)("p",{onClick:function(){j(""),f(""),n("none")},children:"Cancel"})]})]})}function ot(e){var t=e.addContactDisplay,n=e.setaddContactDisplay,o=Object(l.b)(),a=Object(l.c)(A),r=Object(l.c)(B),s=Object(c.useState)(""),d=Object(i.a)(s,2),j=d[0],b=d[1],p=Object(c.useState)(""),m=Object(i.a)(p,2),f=m[0],O=m[1],v=Object(c.useState)(null),h=Object(i.a)(v,2),x=h[0],_=h[1],y=Object(c.useState)(""),C=Object(i.a)(y,2),k=C[0],N=C[1];return Object(c.useEffect)((function(){if(!0===x&&(O("yes"),console.log("result true"),console.log(x),N("User exists")),!1===x&&(O("no"),N("User doesn't exist"),console.log("result false"),console.log(x)),(null===x||void 0===x?void 0:x.email)===j&&(null===x||void 0===x?void 0:x.email)!==a.email){!function(){var e=r.find((function(e){return e.members[0]._id===x._id||e.members[1]._id===x._id}));if(console.log("already"),console.log(e),e)console.log("Contact not created as it already exits"),O("done"),b(""),N("Contact Already Exists");else{var t={members:[a._id,x._id]};o(function(e,t){return function(){var n=Object(be.a)(je.a.mark((function n(c){var o;return je.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,xe(e);case 3:(o=n.sent)&&console.log("Contact Created"),console.log("createContact: all good"),Be(Pe.addNewContact,Object(u.a)(Object(u.a)({},o.data),{},{members:t})),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(0),c(g({error:n.t0})),console.log(n.t0);case 13:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e){return n.apply(this,arguments)}}()}({contact:t},[a,x])),O("done"),b(""),N("Contact Created")}}()}else(null===x||void 0===x?void 0:x.email)===a.email&&(O("done"),b(""),N("Lol, this is you email, ".concat(a.username.split(" ")[0]," try again")))}),[x,j,a,r,o]),Object(ce.jsxs)("div",{className:"addContact",style:{display:"".concat(t)},children:[Object(ce.jsxs)("form",{onSubmit:function(e){e.preventDefault(),o(Te(j,_))},children:[Object(ce.jsx)("input",{value:j,style:{display:"done"===f?"none":"inline"},onChange:function(e){return b(e.target.value.trim())},required:!0,type:"email",title:"format: xxx@gmail.com",placeholder:"exple@gmail.com"}),j.length>5&&Object(ce.jsx)("button",{type:"submit",style:{display:""===f?"inline":"none"},children:"Search"})]}),k&&Object(ce.jsx)("span",{children:k}),Object(ce.jsx)("p",{className:"addContactAdd",style:{display:"yes"===f?"inline":"none"},onClick:function(){o(Fe(j,_))},children:"Add"}),Object(ce.jsx)("p",{className:"addContactCancel",onClick:function(){O(""),b(""),N(""),_(null),n("none")},children:"Cancel"})]})}var at=function(){var e=Object(l.b)(),t=Object(l.c)(A),n=Object(c.useState)("none"),o=Object(i.a)(n,2),a=o[0],r=o[1];return Object(ce.jsxs)("div",{className:"sidebarHeader",children:[Object(ce.jsxs)("div",{className:"sidebarHeader_left",onClick:function(){return e(q(!0))},children:[Object(ce.jsx)("div",{className:"sidebarHeader_avatar",children:Object(ce.jsx)(te.a,{src:t.photoUrl})}),Object(ce.jsx)("span",{children:t.username})]}),Object(ce.jsxs)("div",{className:"sidebarHeader_icons",children:[Object(ce.jsx)(ee.a,{onClick:function(){r("flex")}}),Object(ce.jsx)(nt,{moreDisplay:a,setmoreDisplay:r})]})]})};n(138);var rt=function(){var e=Object(l.b)(),t=Object(l.c)(K);return Object(ce.jsxs)("div",{className:"searchBar",children:[Object(ce.jsxs)("form",{children:[Object(ce.jsx)("input",{value:t,onChange:function(t){e(Y(t.target.value)),e(H("searchResults"))},type:"text",placeholder:"Search"}),Object(ce.jsx)("button",{onClick:function(t){t.preventDefault(),e(H("searchResults"))},type:"submit",children:"Search"})]}),Object(ce.jsx)(ne.a,{className:"searchBar_close",onClick:function(){e(W(!1))}})]})},st=function(e){e.setshowSearch;var t=Object(l.b)();return Object(ce.jsxs)("div",{className:"sidebarSubHeader_elements",children:[Object(ce.jsx)("div",{className:"sidebarSubHeader_search",children:Object(ce.jsx)(le.b,{onClick:function(){t(Y("")),t(W(!0))}})}),Object(ce.jsx)("span",{onClick:function(){return t(H("contacts"))},children:"Contacts"}),Object(ce.jsx)("span",{onClick:function(){return t(H("groups"))},children:"Groups"})]})},it=function(){var e=Object(l.c)(X);return Object(ce.jsx)("div",{className:"sidebarSubHeader",children:e?Object(ce.jsx)(rt,{}):Object(ce.jsx)(st,{})})};n(139);var lt=function(){var e=Object(l.c)(A),t=Object(l.c)(J),n=Object(l.c)(K),c=Object(l.c)(U),o=Object(l.c)(B);return Object(ce.jsxs)("div",{className:"sidebar",children:[Object(ce.jsx)(at,{}),Object(ce.jsx)(it,{}),"contacts"===t&&Object(ce.jsx)("div",{className:"sidebar_bottom",children:o&&o.map((function(e){return Object(ce.jsx)(et,{contact:e},e._id)}))}),"groups"===t&&Object(ce.jsx)("div",{className:"sidebar_bottom",children:c&&c.map((function(e){return Object(ce.jsx)(tt,{group:e},e._id)}))}),"searchResults"===t&&Object(ce.jsxs)("div",{className:"sidebar_bottom",children:[c&&c.map((function(e){var t=e.groupname.trim().toLowerCase(),c=n.trim().toLowerCase();return t.includes(c)&&c&&Object(ce.jsx)(tt,{group:e},e._id)})),o&&o.map((function(t){if(t.members[0]._id!==e._id){var c=t.members[0].username.trim().toLowerCase(),o=n.trim().toLowerCase();return c.includes(o)&&Object(ce.jsx)(et,{contact:t},t._id)}var a=t.members[1].username.trim().toLowerCase(),r=n.trim().toLowerCase();return a.includes(r)&&r&&Object(ce.jsx)(et,{contact:t},t._id)}))]})]})};n(140),n(141);var ut=function(e){var t=e.member;return Object(ce.jsxs)("div",{className:"groupMember",children:[Object(ce.jsx)(te.a,{src:t.photoUrl}),Object(ce.jsx)("p",{children:t.username}),Object(ce.jsx)(ee.b,{style:{color:t.is_active?"green":"grey"}})]})};function dt(e){var t=e.group,n=e.addMemberDisplay,o=e.setaddMemberDisplay,a=Object(l.b)(),r=Object(l.c)(A),d=Object(c.useState)(""),j=Object(i.a)(d,2),b=j[0],p=j[1],m=Object(c.useState)(""),f=Object(i.a)(m,2),O=f[0],v=f[1],h=Object(c.useState)(null),x=Object(i.a)(h,2),_=x[0],y=x[1],C=Object(c.useState)(""),k=Object(i.a)(C,2),N=k[0],w=k[1];return Object(c.useEffect)((function(){var e,n;if(!0===_&&(v("yes"),console.log("result true"),console.log(_),w("User exists")),!1===_&&(v("no"),w("User doesn't exist"),console.log("result false"),console.log(_)),(null===_||void 0===_?void 0:_.email)===b&&(null===_||void 0===_?void 0:_.email)!==r.email)if(t.members.find((function(e){return e._id===_._id})))console.log("Member not added as already in group"),v("done"),p(""),w("Member Already Part Of Group");else{a((e=t._id,n={_id:_._id},function(){var t=Object(be.a)(je.a.mark((function t(c){return je.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Se(e,n);case 3:t.sent&&console.log("Member Added"),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),c(g({error:t.t0})),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()));var c=[].concat(Object(s.a)(t.members),[_]);a(L({_id:t._id,group:Object(u.a)(Object(u.a)({},t),{},{members:c})})),Be(Pe.addNewMember,{_id:t._id,group:Object(u.a)(Object(u.a)({},t),{},{members:c}),member:_}),console.log("Member info sent to server"),v("done"),p(""),w("Member Added")}(null===_||void 0===_?void 0:_.email)===r.email&&(console.log("You are a member of this group"),v("done"),p(""),y(null),w("You are a member of this group "))}),[_,b,r,t,t._id,t.members,a]),Object(ce.jsxs)("div",{className:"addMember",style:{display:"".concat(n)},children:[Object(ce.jsxs)("form",{onSubmit:function(e){e.preventDefault(),a(Te(b,y))},children:[Object(ce.jsx)("input",{value:b,style:{display:""===O?"inline":"none"},onChange:function(e){return p(e.target.value.trim())},required:!0,type:"email",title:"format: xxx@gmail.com",placeholder:"exple@gmail.com"}),b.length>5&&Object(ce.jsx)("button",{type:"submit",style:{display:""===O?"inline":"none"},children:"Search"})]}),N&&Object(ce.jsx)("span",{children:N}),Object(ce.jsx)("p",{className:"addMemberAdd",style:{display:"yes"===O?"inline":"none"},onClick:function(){a(Fe(b,y))},children:"Add"}),Object(ce.jsx)("p",{className:"addMemberCancel",onClick:function(){v(""),p(""),w(""),y(null),o("none")},children:"Cancel"})]})}var jt=function(){var e=Object(l.b)(),t=Object(l.c)(A),n=Object(l.c)(U),o=Object(l.c)(Z),a=Object(c.useState)(null),r=Object(i.a)(a,2),s=r[0],d=r[1],j=Object(c.useState)("none"),b=Object(i.a)(j,2),p=b[0],m=b[1],f=Object(c.useState)(""),O=Object(i.a)(f,2),v=O[0],h=O[1],x=Object(c.useState)(""),_=Object(i.a)(x,2),y=_[0],k=_[1];Object(c.useEffect)((function(){if("group"===o.type){var e=n.find((function(e){return e._id===o._id}));d(e)}}),[o._id,o.type,n,n.members]);var N=Object(c.useState)("none"),w=Object(i.a)(N,2),M=w[0],G=w[1],E=function(){var n=function(){var n,c;e((n=null===s||void 0===s?void 0:s._id,c=t._id,function(){var e=Object(be.a)(je.a.mark((function e(t){return je.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,De(n,c);case 3:e.sent&&console.log("deleteMember: all good"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),t(g({error:e.t0})),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()));var a=[];s.members.forEach((function(e){e._id!==t._id&&a.push(e)})),e(C({_id:s._id})),Be(Pe.leaveGroup,{_id:s._id,group:Object(u.a)(Object(u.a)({},s),{},{members:a})}),e(z(Object(u.a)(Object(u.a)({},o),{},{type:"",_id:null,toggle:!1})))};return Object(ce.jsxs)("div",{className:"groupProfile_bottom_LD",style:{display:"".concat(M)},children:[Object(ce.jsxs)("span",{children:["Are you sure you wanna leave <<",null===s||void 0===s?void 0:s.groupname,">>?"]}),Object(ce.jsx)("p",{onClick:function(){return n()},children:"Yes"}),Object(ce.jsx)("p",{onClick:function(){return G("none")},children:"No"})]})},L=Object(c.useState)("none"),P=Object(i.a)(L,2),B=P[0],R=P[1],T=function(){var t=function(){var t;e((t=s._id,function(){var e=Object(be.a)(je.a.mark((function e(n){return je.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ie(t);case 3:e.sent&&console.log("Group Deleted :)"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),n(g({error:e.t0})),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())),Be(Pe.deleteGroup,{_id:s._id}),e(C({_id:s._id})),e(z(Object(u.a)(Object(u.a)({},o),{},{type:"",_id:null,toggle:!1})))};return Object(ce.jsxs)("div",{className:"groupProfile_bottom_LD",style:{display:"".concat(B)},children:[Object(ce.jsxs)("span",{children:['Are you sure you wanna "DELETE" <<',null===s||void 0===s?void 0:s.groupname,">>?"]}),Object(ce.jsx)("p",{onClick:function(){return t()},children:"Yes"}),Object(ce.jsx)("p",{onClick:function(){return R("none")},children:"No"})]})},F=Object(c.useState)("none"),H=Object(i.a)(F,2),Y=H[0],q=H[1],Q=function(){var t=function(){var t;e((t=null===s||void 0===s?void 0:s._id,function(){var e=Object(be.a)(je.a.mark((function e(n){return je.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ee(t);case 3:e.sent&&console.log("All Group Messages Deleted"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),n(g({error:e.t0})),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())),q("none"),e(z(Object(u.a)(Object(u.a)({},o),{},{toggle:!1}))),e(S({_id:s._id,type:"group"})),Be(Pe.deleteGroupMessages,{_id:s._id,type:"group"})};return Object(ce.jsxs)("div",{className:"groupProfile_bottom_LD",style:{display:"".concat(Y)},children:[Object(ce.jsx)("span",{children:'Are you sure you wanna "DELETE  ALL MESSAGES"?'}),Object(ce.jsx)("p",{onClick:function(){return t()},children:"Yes"}),Object(ce.jsx)("p",{onClick:function(){return q("none")},children:"No"})]})},W=Object(c.useState)("none"),X=Object(i.a)(W,2),J=X[0],K=X[1],V=Object(c.useState)("none"),$=Object(i.a)(V,2),ee=$[0],te=$[1];return Object(ce.jsx)(ce.Fragment,{children:s&&Object(ce.jsxs)("div",{className:"groupProfile",children:[Object(ce.jsxs)("div",{className:"groupProfile_top",children:[Object(ce.jsx)("p",{children:"Group info"}),Object(ce.jsx)(ne.a,{onClick:function(){return e(z(Object(u.a)(Object(u.a)({},o),{},{type:"group",toggle:!1})))}})]}),Object(ce.jsxs)("div",{className:"groupProfile_scroll",children:[Object(ce.jsxs)("div",{className:"groupProfile_middle",children:[Object(ce.jsx)("img",{src:s.photoUrl,alt:""}),Object(ce.jsxs)("div",{className:"groupProfile_info",children:[Object(ce.jsxs)("p",{children:[s.groupname,Object(ce.jsx)("span",{onClick:function(){return te("flex")},children:"Edit"})]}),Object(ce.jsxs)("span",{children:["created: ",re()(s.created_at).calendar()]})]}),Object(ce.jsxs)("form",{onSubmit:function(t){var n,c;t.preventDefault(),y.trim()&&(e((n=s._id,c={groupname:y.trim()},function(){var e=Object(be.a)(je.a.mark((function e(t){return je.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Me(n,c);case 3:e.sent&&console.log("Group name updated :-)"),Be(Pe.editGroupName,{_id:n,groupname:c.groupname}),t(D({_id:n,groupname:c.groupname})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),t(g({error:e.t0})),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}())),k(""),te("none"))},name:"changeName",style:{display:ee},children:[Object(ce.jsx)("input",{value:y,type:"text",placeholder:"Enter name",onChange:function(e){return k(e.target.value)}}),Object(ce.jsx)("button",{type:"submit",children:"Rename"}),Object(ce.jsx)("button",{onClick:function(){k(""),te("none")},children:"Cancel"})]})]}),Object(ce.jsxs)("div",{className:"groupProfile_details",children:[Object(ce.jsxs)("h5",{children:["Description ",Object(ce.jsx)("span",{onClick:function(){return K("flex")},children:"Edit"})]}),Object(ce.jsx)("span",{children:s.description?s.description:"No Description"}),Object(ce.jsxs)("form",{onSubmit:function(t){var n,c;t.preventDefault(),v.trim()&&(e((n=s._id,c={description:v.trim()},function(){var e=Object(be.a)(je.a.mark((function e(t){return je.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ge(n,c);case 3:e.sent&&console.log("Group description updated :)"),Be(Pe.editGroupDescription,{_id:n,description:c.description}),t(I({_id:n,description:c.description})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),t(g({error:e.t0})),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}())),h(""),K("none"))},name:"changeDescription",style:{display:J},children:[Object(ce.jsx)("textarea",{value:v,spellCheck:!0,type:"text",rows:"5",name:"Description",placeholder:"Enter description",onChange:function(e){return h(e.target.value)}}),Object(ce.jsx)("button",{type:"submit",children:"Edit"}),Object(ce.jsx)("button",{onClick:function(){h(""),K("none")},children:"Cancel"})]})]}),Object(ce.jsx)("span",{children:"Group members"}),Object(ce.jsx)("div",{className:"groupProfile_members",children:s.members.map((function(e){return Object(ce.jsx)(ut,{member:e},null===e||void 0===e?void 0:e._id)}))}),Object(ce.jsxs)("div",{className:"groupProfile_bottom",children:[Object(ce.jsx)(dt,{group:s,addMemberDisplay:p,setaddMemberDisplay:m}),Object(ce.jsx)("button",{onClick:function(){return m("flex")},children:"Add Member "}),s.members.length>1&&Object(ce.jsx)("button",{onClick:function(){return G("flex")},children:"Leave Group"}),Object(ce.jsx)(E,{}),(null===s||void 0===s?void 0:s.messages.length)>0&&Object(ce.jsx)("button",{className:"groupProfile_delete",onClick:function(){return q("flex")},children:"Delete All Messages"}),Object(ce.jsx)(Q,{}),Object(ce.jsx)("button",{className:"groupProfile_delete",onClick:function(){return R("flex")},children:"Delete Group"}),Object(ce.jsx)(T,{})]})]})]})})},bt=n(57);var pt=function(){var e=Object(l.b)(),t=Object(l.c)(A),n=Object(l.c)(V),o=Object(l.c)(Z),a=Object(l.c)(U),r=Object(l.c)(B),d=Object(c.useState)(null),j=Object(i.a)(d,2),b=j[0],p=j[1],m=Object(c.useState)(null),v=Object(i.a)(m,2),x=v[0],y=v[1],S=Object(c.useState)(t.groups.length+t.contacts.length),G=Object(i.a)(S,2),E=G[0],R=G[1];return Object(c.useEffect)((function(){var n,c;!function(e,t){Ae=Object(Le.a)("https://messengerapp-backend.herokuapp.com/",Ue),console.log("socket connected"),Ae.emit(Pe.join,e),t(h(!0))}(t._id,e),Be(Pe.sendMessage,t.username+" is connected to server"),n=Pe.receiveMessage,c=function(e){return console.log(e)},Ae?Ae.on(n,(function(e){c(e)})):console.log("no socket was connected"),function(e,t,n){Ae&&Ae.on(e,(function(e){n(_(e)),e.userId!==t.id&&Be(Pe.updateOnlineStatus,Object(u.a)(Object(u.a)({},e),{},{is_active:!0,userId:t._id}))}))}(Pe.updateOnlineStatus,t,e),function(e,t){Ae&&Ae.on(e,(function(e){t(_(e))}))}(Pe.updateNewStatus,e),function(e,t){Ae&&Ae.on(e,(function(e){t(M(e))}))}(Pe.editName,e),function(e,t){Ae&&Ae.on(e,(function(e){t(D(e))}))}(Pe.editGroupName,e),function(e,t){Ae&&Ae.on(e,(function(e){t(I(e))}))}(Pe.editGroupDescription,e),function(e,t){console.log("hello world"),Ae&&Ae.on(e,(function(e){t(P(e)),console.log("new ".concat(e.type," message "))}))}(Pe.newMessage,e),function(e,t){Ae&&Ae.on(e,(function(e){t(k(e))}))}(Pe.updateBlock,e),function(e,t,n){Ae&&Ae.on(e,(function(e){var c=e.members;console.log("from io addNewContact"),c[0].email===t.email&&(n(N(e)),Be(Pe.joinContact,{contact:e,is_active:!0,userId:t._id})),c[1].email===t.email&&(n(N(e)),Be(Pe.joinContact,{contact:e,is_active:!0,userId:t._id}))}))}(Pe.addNewContact,t,e),function(e,t){Ae&&Ae.on(e,(function(e){console.log("addMember successful"),t(L(e))}))}(Pe.addNewMember,e),function(e,t){Ae&&Ae.on(e,(function(e){console.log("remove member successful"),t(L(e))}))}(Pe.leaveGroup,e),function(e,t,n){Ae&&Ae.on(e,(function(e){var c=e.member,o=e.group;t._id===c._id&&(n(Ye(o._id,t,(function(e){return n(w(e))}))),console.log("connectToNewGroup successful"))}))}(Pe.connectMemberToGroup,t,e),Re(Pe.deleteContactMessages,e),Re(Pe.deleteGroupMessages,e),function(e,t){Ae&&Ae.on(e,(function(e){console.log("deleteGroup successful"),t(C(e))}))}(Pe.deleteGroup,e)}),[e]),Object(c.useEffect)((function(){t.contacts&&t.contacts.forEach((function(n){e(function(e,t,n){return function(){var c=Object(be.a)(je.a.mark((function c(o){var a;return je.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,he(e);case 3:a=c.sent,n(a.data),Be(Pe.joinContact,{contact:a.data,is_active:!0,userId:t._id}),console.log("fetchContact: all good"),c.next=13;break;case 9:c.prev=9,c.t0=c.catch(0),o(g({error:c.t0})),console.log(c.t0);case 13:case"end":return c.stop()}}),c,null,[[0,9]])})));return function(e){return c.apply(this,arguments)}}()}(n,t,y))})),t.groups&&t.groups.forEach((function(n){e(Ye(n,t,p))}))}),[e]),Object(c.useEffect)((function(){x&&(e(O([].concat(Object(s.a)(r),[x]))),R(E-1))}),[x,e]),Object(c.useEffect)((function(){b&&(e(f([].concat(Object(s.a)(a),[b]))),R(E-1))}),[b,e]),E>0?Object(ce.jsx)(bt.RotateCircleLoading,{color:"#0E59ED"}):Object(ce.jsxs)("div",{className:"appChat",children:[n?Object(ce.jsx)(Ze,{}):Object(ce.jsx)(lt,{}),o.toggle?"contact"===o.type?Object(ce.jsx)(Xe,{}):Object(ce.jsx)(jt,{}):Object(ce.jsx)(We,{})]})},mt=(n(177),n(85));var ft=function(){var e=Object(l.b)(),t=Object(mt.a)(Ke),n=Object(i.a)(t,1)[0];return Object(c.useEffect)((function(){Ke.onAuthStateChanged((function(t){if(t){var n={id:t.uid,username:t.displayName,email:t.email,photoUrl:t.photoURL};e((c=n,function(){var e=Object(be.a)(je.a.mark((function e(t){var n;return je.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fe(c);case 3:n=e.sent,t(p(n.data[0])),t(x(!0)),t(h(!0)),console.log("fetchCreateUser"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),t(g({error:e.t0})),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()))}else e(m());var c}))}),[e]),n?Object(ce.jsx)(bt.RotateCircleLoading,{color:"#0E59ED"}):Object(ce.jsx)("div",{children:Object(ce.jsxs)("div",{className:"login",children:[Object(ce.jsx)("img",{src:"https://i.postimg.cc/zXqXxPvQ/logoblue-clear.png",alt:"logo"}),Object(ce.jsx)("div",{className:"login-button",children:Object(ce.jsx)("button",{onClick:function(){e(x(!1)),Ke.signInWithPopup(Ve).catch((function(t){return e(g({loginError:t,isLoggedIn:!1}))}))},children:"Sign-In with google"})})]})})};var Ot=function(){var e=Object(l.c)(A);return Object(c.useEffect)((function(){return function(){Ae?(Ae.disconnect(),console.log("socket disconnected")):console.log("no socket was connected")}}),[]),Object(ce.jsx)("div",{className:"app",children:e?Object(ce.jsx)(pt,{}):Object(ce.jsx)(ft,{})})},gt=Object(d.a)({reducer:{user:R,option:$}});r.a.render(Object(ce.jsx)(o.a.StrictMode,{children:Object(ce.jsx)(l.a,{store:gt,children:Object(ce.jsx)(Ot,{})})}),document.getElementById("root"))},65:function(e,t,n){},98:function(e,t,n){}},[[178,1,2]]]);
//# sourceMappingURL=main.616864eb.chunk.js.map